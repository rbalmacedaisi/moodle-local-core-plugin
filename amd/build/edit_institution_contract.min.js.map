{"version":3,"file":"edit_institution_contract.min.js","sources":["../src/edit_institution_contract.js"],"sourcesContent":["import * as Ajax from 'core/ajax';\nimport $ from 'jquery';\n\nconst contractNumberInput = $('#contractnumber')\nconst startDateInput = $('#startdate')\nconst endDateInput = $('#enddate')\nconst budgetInput = $('#budget')\nconst billingConditionInput = $('#billing_condition')\nconst saveContractButton = $('#save-contract-button')\nconst cancelContractUpdateButton = $('#cancel-contract-update-button')\n\nconst contractInputs = [contractNumberInput,startDateInput,endDateInput,budgetInput,billingConditionInput]\n\nconst errorModal = $('#errorModal');\nconst errorModalContent = $('#error-modal-content');\n\nlet selectedContractId;\nlet selectedInstitutionId;\n\nexport const init = (contractId,institutionId) => {\n    selectedContractId = contractId\n    selectedInstitutionId = institutionId\n    handleSaveContractButtonClick()\n    handleBudgetInput()\n    handleContractCreationButtonClick()\n};\n\nconst handleSaveContractButtonClick = () => {\n    saveContractButton.click(()=>{\n        // Check the select inputs and the time inputs\n        const valid = contractInputs.every(input => {\n            return input.get(0).reportValidity();\n        });\n        if (!valid) {\n            return;\n        }\n        //\n        \n        // Check if the init time is less than the end time of the class\n        if (startDateInput.val() >= endDateInput.val()) {\n            endDateInput.get(0).setCustomValidity('La fecha de finalizaci√≥n debe ser mayor a la hora de inicio.');\n            endDateInput.get(0).reportValidity();\n            return;\n        }\n        //\n        \n        const args = {\n            id:selectedContractId,\n            institutionId:selectedInstitutionId,\n            contractId:contractNumberInput.val(),\n            initDate: startDateInput.val(),\n            expectedEndDate: endDateInput.val(),\n            budget: budgetInput.val(),\n            billingCondition: billingConditionInput.val(),\n        };\n\n        const promise = Ajax.call([{\n            methodname: 'local_grupomakro_update_institution_contract',\n            args\n        }, ]);\n        promise[0].done(function(response) {\n            if(response.institutionContractId === -1 ){\n                errorModalContent.html(`<p class=\"text-center\">${response.message}</p>`);\n                errorModal.modal('show');\n                return   \n            }\n            window.location.href = `/local/grupomakro_core/pages/institutionalcontracts.php?id=${selectedInstitutionId}`;\n        }).fail(function(error) {\n            console.error(error)\n        });\n    })\n}\n\nconst handleBudgetInput = () => {\n    budgetInput.on('input', function() {\n      var value = $(this).val().replace(/[^\\d]/g, ''); // Remove non-digit characters\n      value = value.replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.'); // Add dots as thousands separators\n      $(this).val(value); // Set the formatted value back to the input\n    });\n}\n\nconst handleContractCreationButtonClick = ()=>{\n    cancelContractUpdateButton.click(()=>{\n        window.location.href = `/local/grupomakro_core/pages/institutionalcontracts.php?id=${selectedInstitutionId}`;\n    })\n    \n}\n\n"],"names":["selectedContractId","selectedInstitutionId","contractNumberInput","startDateInput","endDateInput","budgetInput","billingConditionInput","saveContractButton","cancelContractUpdateButton","contractInputs","errorModal","errorModalContent","contractId","institutionId","handleSaveContractButtonClick","handleBudgetInput","handleContractCreationButtonClick","click","every","input","get","reportValidity","val","setCustomValidity","args","id","initDate","expectedEndDate","budget","billingCondition","Ajax","call","methodname","done","response","institutionContractId","html","message","modal","window","location","href","fail","error","console","on","value","this","replace"],"mappings":"44CAgBIA,mBACAC,sBAdEC,qBAAsB,qEAAE,mBACxBC,gBAAiB,mBAAE,cACnBC,cAAe,mBAAE,YACjBC,aAAc,mBAAE,WAChBC,uBAAwB,mBAAE,sBAC1BC,oBAAqB,mBAAE,yBACvBC,4BAA6B,mBAAE,kCAE/BC,eAAiB,CAACP,oBAAoBC,eAAeC,aAAaC,YAAYC,uBAE9EI,YAAa,mBAAE,eACfC,mBAAoB,mBAAE,sCAKR,SAACC,WAAWC,eAC5Bb,mBAAqBY,WACrBX,sBAAwBY,cACxBC,gCACAC,oBACAC,yCAGEF,8BAAgC,WAClCP,mBAAmBU,OAAM,cAEPR,eAAeS,OAAM,SAAAC,cACxBA,MAAMC,IAAI,GAAGC,wBAQpBlB,eAAemB,OAASlB,aAAakB,aACrClB,aAAagB,IAAI,GAAGG,kBAAkB,qEACtCnB,aAAagB,IAAI,GAAGC,qBAKlBG,KAAO,CACTC,GAAGzB,mBACHa,cAAcZ,sBACdW,WAAWV,oBAAoBoB,MAC/BI,SAAUvB,eAAemB,MACzBK,gBAAiBvB,aAAakB,MAC9BM,OAAQvB,YAAYiB,MACpBO,iBAAkBvB,sBAAsBgB,OAG5BQ,KAAKC,KAAK,CAAC,CACvBC,WAAY,+CACZR,KAAAA,QAEI,GAAGS,MAAK,SAASC,cACkB,IAApCA,SAASC,6BACRxB,kBAAkByB,sCAA+BF,SAASG,sBAC1D3B,WAAW4B,MAAM,QAGrBC,OAAOC,SAASC,0EAAqExC,0BACtFyC,MAAK,SAASC,OACbC,QAAQD,MAAMA,eAKpB5B,kBAAoB,WACtBV,YAAYwC,GAAG,SAAS,eAClBC,OAAQ,mBAAEC,MAAMzB,MAAM0B,QAAQ,SAAU,IAC5CF,MAAQA,MAAME,QAAQ,wBAAyB,yBAC7CD,MAAMzB,IAAIwB,WAIZ9B,kCAAoC,WACtCR,2BAA2BS,OAAM,WAC7BsB,OAAOC,SAASC,0EAAqExC"}