{"version":3,"file":"edit_institution_contract.min.js","sources":["../src/edit_institution_contract.js"],"sourcesContent":["import * as Ajax from 'core/ajax';\nimport $ from 'jquery';\n\nconst contractNumberInput = $('#contractnumber');\nconst startDateInput = $('#startdate');\nconst endDateInput = $('#enddate');\nconst budgetInput = $('#budget');\nconst billingConditionInput = $('#billing_condition');\nconst saveContractButton = $('#save-contract-button');\nconst cancelContractUpdateButton = $('#cancel-contract-update-button');\n\nconst contractInputs = [contractNumberInput, startDateInput, endDateInput, budgetInput, billingConditionInput];\n\nconst errorModal = $('#errorModal');\nconst errorModalContent = $('#error-modal-content');\n\nlet selectedContractId;\nlet selectedInstitutionId;\n\nexport const init = (contractId, institutionId) => {\n    selectedContractId = contractId;\n    selectedInstitutionId = institutionId;\n    handleSaveContractButtonClick();\n    handleBudgetInput();\n    handleContractCreationButtonClick();\n};\n\nconst handleSaveContractButtonClick = () => {\n    saveContractButton.click(()=>{\n        endDateInput.get(0).setCustomValidity('');\n        // Check the select inputs and the time inputs\n        const valid = contractInputs.every(input => {\n            return input.get(0).reportValidity();\n        });\n        if (!valid) {\n            return;\n        }\n        //\n\n        // Check if the init time is less than the end time of the class\n        if (startDateInput.val() >= endDateInput.val()) {\n            endDateInput.get(0).setCustomValidity('La fecha de finalizaci√≥n debe ser mayor a la hora de inicio.');\n            endDateInput.get(0).reportValidity();\n            return;\n        }\n        //\n\n        const args = {\n            id: selectedContractId,\n            institutionId: selectedInstitutionId,\n            contractId: contractNumberInput.val(),\n            initDate: startDateInput.val(),\n            expectedEndDate: endDateInput.val(),\n            budget: budgetInput.val(),\n            billingCondition: billingConditionInput.val(),\n        };\n\n        const promise = Ajax.call([{\n            methodname: 'local_grupomakro_update_institution_contract',\n            args\n        }]);\n        promise[0].done(function(response) {\n            if (response.institutionContractId === -1) {\n                errorModalContent.html(`<p class=\"text-center\">${response.message}</p>`);\n                errorModal.modal('show');\n                return;\n            }\n            window.location.href = `/local/grupomakro_core/pages/institutionalcontracts.php?id=${selectedInstitutionId}`;\n        }).fail(function(error) {\n            console.error(error);\n        });\n    });\n};\n\nconst handleBudgetInput = () => {\n    budgetInput.on('input', function() {\n      var value = $(this).val().replace(/[^\\d]/g, ''); // Remove non-digit characters\n      value = value.replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.'); // Add dots as thousands separators\n      $(this).val(value); // Set the formatted value back to the input\n    });\n};\n\nconst handleContractCreationButtonClick = ()=>{\n    cancelContractUpdateButton.click(()=>{\n        window.location.href = `/local/grupomakro_core/pages/institutionalcontracts.php?id=${selectedInstitutionId}`;\n    });\n\n};\n\n"],"names":["contractNumberInput","startDateInput","endDateInput","budgetInput","billingConditionInput","saveContractButton","cancelContractUpdateButton","contractInputs","errorModal","errorModalContent","selectedContractId","selectedInstitutionId","contractId","institutionId","handleSaveContractButtonClick","handleBudgetInput","handleContractCreationButtonClick","click","get","setCustomValidity","every","input","reportValidity","val","args","id","initDate","expectedEndDate","budget","billingCondition","Ajax","call","methodname","done","response","institutionContractId","html","message","modal","window","location","href","fail","error","console","on","value","this","replace"],"mappings":"ioCAGMA,qBAAsB,qEAAE,mBACxBC,gBAAiB,mBAAE,cACnBC,cAAe,mBAAE,YACjBC,aAAc,mBAAE,WAChBC,uBAAwB,mBAAE,sBAC1BC,oBAAqB,mBAAE,yBACvBC,4BAA6B,mBAAE,kCAE/BC,eAAiB,CAACP,oBAAqBC,eAAgBC,aAAcC,YAAaC,uBAElFI,YAAa,mBAAE,eACfC,mBAAoB,mBAAE,4BAExBC,mBACAC,oCAEgB,CAACC,WAAYC,iBAC7BH,mBAAqBE,WACrBD,sBAAwBE,cACxBC,gCACAC,oBACAC,2CAGEF,8BAAgC,KAClCT,mBAAmBY,OAAM,KACrBf,aAAagB,IAAI,GAAGC,kBAAkB,QAExBZ,eAAea,OAAMC,OACxBA,MAAMH,IAAI,GAAGI,6BAQpBrB,eAAesB,OAASrB,aAAaqB,aACrCrB,aAAagB,IAAI,GAAGC,kBAAkB,qEACtCjB,aAAagB,IAAI,GAAGI,uBAKlBE,KAAO,CACTC,GAAIf,mBACJG,cAAeF,sBACfC,WAAYZ,oBAAoBuB,MAChCG,SAAUzB,eAAesB,MACzBI,gBAAiBzB,aAAaqB,MAC9BK,OAAQzB,YAAYoB,MACpBM,iBAAkBzB,sBAAsBmB,OAG5BO,KAAKC,KAAK,CAAC,CACvBC,WAAY,+CACZR,KAAAA,QAEI,GAAGS,MAAK,SAASC,cACmB,IAApCA,SAASC,6BACT1B,kBAAkB2B,KAAM,0BAAyBF,SAASG,oBAC1D7B,WAAW8B,MAAM,QAGrBC,OAAOC,SAASC,KAAQ,8DAA6D9B,2BACtF+B,MAAK,SAASC,OACbC,QAAQD,MAAMA,cAKpB5B,kBAAoB,KACtBZ,YAAY0C,GAAG,SAAS,eAClBC,OAAQ,mBAAEC,MAAMxB,MAAMyB,QAAQ,SAAU,IAC5CF,MAAQA,MAAME,QAAQ,wBAAyB,yBAC7CD,MAAMxB,IAAIuB,WAIZ9B,kCAAoC,KACtCV,2BAA2BW,OAAM,KAC7BsB,OAAOC,SAASC,KAAQ,8DAA6D9B"}