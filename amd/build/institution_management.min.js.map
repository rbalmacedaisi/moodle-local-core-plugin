{"version":3,"file":"institution_management.min.js","sources":["../src/institution_management.js"],"sourcesContent":["import * as Ajax from 'core/ajax';\nimport $ from 'jquery';\n\nconst createInstitutionNameInput = $('#create_name_institution')\nconst createInstitutionIdInput = $('#create_id_institution')\nconst saveInstitutionButton = $('#saveInstitutionButton')\nconst updateInstitutionNameInput = $('#update_name_institution')\nconst updateInstitutionIdInput = $('#update_id_institution')\nconst updateInstitutionButton = $('#updateInstitutionButton')\nconst updateInstitutionModal = $('#updateInstitutionModalLong')\nconst deleteInstitutionModal = $('#deleteInstitutionModalLong')\nconst editInstitutionButtons = $('.edit-institution-button')\nconst deleteInstitutionButtons = $('.delete-institution-button')\nconst viewInstitutionButtons = $('.view-institution')\nconst confirmDeleteInstitutionButton = $('#confirmDeleteInstitutionButton')\n\nconst errorModal = $('#errorModal');\nconst errorModalContent = $('#error-modal-content');\n\nconst createInputs = [ createInstitutionNameInput,createInstitutionIdInput];\nconst updateInputs = [ updateInstitutionNameInput,updateInstitutionIdInput];\n\nlet institutions;\nlet institutionId;\n\nexport const init = (institutionList) => {\n    institutions = institutionList\n    handleSaveButton()\n    handleEditButton()\n    handleUpdateButton()\n    handleDeleteButton()\n    handleConfirmDeletionButton()\n    handleViewInstitutionButton()\n};\n\nconst handleViewInstitutionButton = () => {\n    viewInstitutionButtons.click((event)=>{\n        institutionId = event.currentTarget.attributes['institution-id'].value\n        window.location.href =  `/local/grupomakro_core/pages/institutionalcontracts.php?id=${institutionId}`\n    })\n}\n\nconst handleConfirmDeletionButton = () => {\n    confirmDeleteInstitutionButton.click(()=>{\n        const args = {\n            id:institutionId,\n        };\n        const promise = Ajax.call([{\n            methodname: 'local_grupomakro_delete_institution',\n            args\n        }, ]);\n        promise[0].done(function(response) {\n            if(response.institutionId === -1 ){\n                deleteInstitutionModal.modal('hide')\n                errorModalContent.html(`<p class=\"text-center\">${response.message}</p>`);\n                errorModal.modal('show');\n                return   \n            }\n            window.location.href = '/local/grupomakro_core/pages/institutionmanagement.php';\n        }).fail(function(error) {\n            console.error(error)\n        });\n    })\n\n}\n\n\nconst handleDeleteButton = () => {\n    deleteInstitutionButtons.click((event)=>{\n        institutionId = event.currentTarget.attributes['institution-id'].value\n        deleteInstitutionModal.modal('show')\n    })\n\n}\n\nconst handleUpdateButton = () => {\n    updateInstitutionButton.click((event)=>{\n         // Check the select inputs and the time inputs\n        const valid = updateInputs.every(input => {\n            return input.get(0).reportValidity();\n        });\n        if (!valid) {\n            return;\n        }\n        //\n        const args = {\n            id:institutionId,\n            name: updateInstitutionNameInput.val(),\n            institutionId: updateInstitutionIdInput.val()\n\n        };\n        const promise = Ajax.call([{\n            methodname: 'local_grupomakro_update_institution',\n            args\n        }, ]);\n        promise[0].done(function(response) {\n            if(response.institutionId === -1 ){\n                errorModalContent.html(`<p class=\"text-center\">${response.message}</p>`);\n                errorModal.modal('show');\n                return   \n            }\n            window.location.href = '/local/grupomakro_core/pages/institutionmanagement.php';\n        }).fail(function(error) {\n            console.error(error)\n        });\n    })\n\n}\n\nconst handleEditButton = () => {\n    editInstitutionButtons.click((event)=>{\n        institutionId = event.currentTarget.attributes['institution-id'].value\n        const selectedInstitution= institutions.find(institution => institutionId === institution.id)\n        updateInstitutionNameInput.val(selectedInstitution.name)\n        updateInstitutionIdInput.val(selectedInstitution.institutionid)\n        updateInstitutionModal.modal('show')\n    })\n\n}\n\nconst handleSaveButton = () => {\n    saveInstitutionButton.click(()=> {\n        // Check the select inputs and the time inputs\n        const valid = createInputs.every(input => {\n            return input.get(0).reportValidity();\n        });\n        if (!valid) {\n            return;\n        }\n        //\n        \n        const args = {\n            name: createInstitutionNameInput.val(),\n            institutionId: createInstitutionIdInput.val()\n\n        };\n        const promise = Ajax.call([{\n            methodname: 'local_grupomakro_create_institution',\n            args\n        }, ]);\n        promise[0].done(function(response) {\n            if(response.institutionId === -1 ){\n                errorModalContent.html(`<p class=\"text-center\">${response.message}</p>`);\n                errorModal.modal('show');\n                return   \n            }\n            window.location.href = '/local/grupomakro_core/pages/institutionmanagement.php';\n        }).fail(function(error) {\n            console.error(error)\n        });\n    })\n}\n\n\n"],"names":["institutions","institutionId","createInstitutionNameInput","createInstitutionIdInput","saveInstitutionButton","updateInstitutionNameInput","updateInstitutionIdInput","updateInstitutionButton","updateInstitutionModal","deleteInstitutionModal","editInstitutionButtons","deleteInstitutionButtons","viewInstitutionButtons","confirmDeleteInstitutionButton","errorModal","errorModalContent","createInputs","updateInputs","institutionList","handleSaveButton","handleEditButton","handleUpdateButton","handleDeleteButton","handleConfirmDeletionButton","handleViewInstitutionButton","click","event","currentTarget","attributes","value","window","location","href","args","id","Ajax","call","methodname","done","response","modal","html","message","fail","error","console","every","input","get","reportValidity","name","val","selectedInstitution","find","institution","institutionid"],"mappings":"y4CAsBIA,aACAC,cApBEC,4BAA6B,qEAAE,4BAC/BC,0BAA2B,mBAAE,0BAC7BC,uBAAwB,mBAAE,0BAC1BC,4BAA6B,mBAAE,4BAC/BC,0BAA2B,mBAAE,0BAC7BC,yBAA0B,mBAAE,4BAC5BC,wBAAyB,mBAAE,+BAC3BC,wBAAyB,mBAAE,+BAC3BC,wBAAyB,mBAAE,4BAC3BC,0BAA2B,mBAAE,8BAC7BC,wBAAyB,mBAAE,qBAC3BC,gCAAiC,mBAAE,mCAEnCC,YAAa,mBAAE,eACfC,mBAAoB,mBAAE,wBAEtBC,aAAe,CAAEd,2BAA2BC,0BAC5Cc,aAAe,CAAEZ,2BAA2BC,wCAK9B,SAACY,iBACjBlB,aAAekB,gBACfC,mBACAC,mBACAC,qBACAC,qBACAC,8BACAC,mCAGEA,4BAA8B,WAChCZ,uBAAuBa,OAAM,SAACC,OAC1BzB,cAAgByB,MAAMC,cAAcC,WAAW,kBAAkBC,MACjEC,OAAOC,SAASC,0EAAsE/B,mBAIxFsB,4BAA8B,WAChCV,+BAA+BY,OAAM,eAC3BQ,KAAO,CACTC,GAAGjC,eAESkC,KAAKC,KAAK,CAAC,CACvBC,WAAY,sCACZJ,KAAAA,QAEI,GAAGK,MAAK,SAASC,cACU,IAA5BA,SAAStC,qBACRQ,uBAAuB+B,MAAM,QAC7BzB,kBAAkB0B,sCAA+BF,SAASG,sBAC1D5B,WAAW0B,MAAM,QAGrBV,OAAOC,SAASC,KAAO,4DACxBW,MAAK,SAASC,OACbC,QAAQD,MAAMA,cAOpBtB,mBAAqB,WACvBX,yBAAyBc,OAAM,SAACC,OAC5BzB,cAAgByB,MAAMC,cAAcC,WAAW,kBAAkBC,MACjEpB,uBAAuB+B,MAAM,YAK/BnB,mBAAqB,WACvBd,wBAAwBkB,OAAM,SAACC,UAEbT,aAAa6B,OAAM,SAAAC,cACtBA,MAAMC,IAAI,GAAGC,yBAMlBhB,KAAO,CACTC,GAAGjC,cACHiD,KAAM7C,2BAA2B8C,MACjClD,cAAeK,yBAAyB6C,OAG5BhB,KAAKC,KAAK,CAAC,CACvBC,WAAY,sCACZJ,KAAAA,QAEI,GAAGK,MAAK,SAASC,cACU,IAA5BA,SAAStC,qBACRc,kBAAkB0B,sCAA+BF,SAASG,sBAC1D5B,WAAW0B,MAAM,QAGrBV,OAAOC,SAASC,KAAO,4DACxBW,MAAK,SAASC,OACbC,QAAQD,MAAMA,eAMpBxB,iBAAmB,WACrBV,uBAAuBe,OAAM,SAACC,OAC1BzB,cAAgByB,MAAMC,cAAcC,WAAW,kBAAkBC,UAC3DuB,oBAAqBpD,aAAaqD,MAAK,SAAAC,oBAAerD,gBAAkBqD,YAAYpB,MAC1F7B,2BAA2B8C,IAAIC,oBAAoBF,MACnD5C,yBAAyB6C,IAAIC,oBAAoBG,eACjD/C,uBAAuBgC,MAAM,YAK/BrB,iBAAmB,WACrBf,sBAAsBqB,OAAM,cAEVT,aAAa8B,OAAM,SAAAC,cACtBA,MAAMC,IAAI,GAAGC,yBAOlBhB,KAAO,CACTiB,KAAMhD,2BAA2BiD,MACjClD,cAAeE,yBAAyBgD,OAG5BhB,KAAKC,KAAK,CAAC,CACvBC,WAAY,sCACZJ,KAAAA,QAEI,GAAGK,MAAK,SAASC,cACU,IAA5BA,SAAStC,qBACRc,kBAAkB0B,sCAA+BF,SAASG,sBAC1D5B,WAAW0B,MAAM,QAGrBV,OAAOC,SAASC,KAAO,4DACxBW,MAAK,SAASC,OACbC,QAAQD,MAAMA"}