{"version":3,"file":"institution_management.min.js","sources":["../src/institution_management.js"],"sourcesContent":["import * as Ajax from 'core/ajax';\nimport $ from 'jquery';\n\nconst createInstitutionNameInput = $('#create_name_institution');\nconst createInstitutionIdInput = $('#create_id_institution');\nconst saveInstitutionButton = $('#saveInstitutionButton');\nconst updateInstitutionNameInput = $('#update_name_institution');\nconst updateInstitutionIdInput = $('#update_id_institution');\nconst updateInstitutionButton = $('#updateInstitutionButton');\nconst updateInstitutionModal = $('#updateInstitutionModalLong');\nconst deleteInstitutionModal = $('#deleteInstitutionModalLong');\nconst editInstitutionButtons = $('.edit-institution-button');\nconst deleteInstitutionButtons = $('.delete-institution-button');\nconst viewInstitutionButtons = $('.view-institution');\nconst confirmDeleteInstitutionButton = $('#confirmDeleteInstitutionButton');\n\nconst errorModal = $('#errorModal');\nconst errorModalContent = $('#error-modal-content');\n\nconst createInputs = [createInstitutionNameInput, createInstitutionIdInput];\nconst updateInputs = [updateInstitutionNameInput, updateInstitutionIdInput];\n\nlet institutions;\nlet institutionId;\n\nexport const init = (institutionList) => {\n    institutions = institutionList;\n    handleSaveButton();\n    handleEditButton();\n    handleUpdateButton();\n    handleDeleteButton();\n    handleConfirmDeletionButton();\n    handleViewInstitutionButton();\n};\n\nconst handleViewInstitutionButton = () => {\n    viewInstitutionButtons.click((event)=>{\n        institutionId = event.currentTarget.attributes['institution-id'].value;\n        window.location.href = `/local/grupomakro_core/pages/institutionalcontracts.php?id=${institutionId}`;\n    });\n};\n\nconst handleConfirmDeletionButton = () => {\n    confirmDeleteInstitutionButton.click(()=>{\n        const args = {\n            id: institutionId,\n        };\n        const promise = Ajax.call([{\n            methodname: 'local_grupomakro_delete_institution',\n            args\n        }]);\n        promise[0].done(function(response) {\n            if (response.institutionId === -1) {\n                deleteInstitutionModal.modal('hide');\n                errorModalContent.html(`<p class=\"text-center\">${response.message}</p>`);\n                errorModal.modal('show');\n                return;\n            }\n            window.location.href = '/local/grupomakro_core/pages/institutionmanagement.php';\n        }).fail(function(error) {\n            window.alert(error);\n        });\n    });\n\n};\n\n\nconst handleDeleteButton = () => {\n    deleteInstitutionButtons.click((event)=>{\n        institutionId = event.currentTarget.attributes['institution-id'].value;\n        deleteInstitutionModal.modal('show');\n    });\n\n};\n\nconst handleUpdateButton = () => {\n    updateInstitutionButton.click(()=>{\n         // Check the select inputs and the time inputs\n        const valid = updateInputs.every(input => {\n            return input.get(0).reportValidity();\n        });\n        if (!valid) {\n            return;\n        }\n        //\n        const args = {\n            id: institutionId,\n            name: updateInstitutionNameInput.val(),\n            institutionId: updateInstitutionIdInput.val()\n\n        };\n        const promise = Ajax.call([{\n            methodname: 'local_grupomakro_update_institution',\n            args\n        }]);\n        promise[0].done(function(response) {\n            if (response.institutionId === -1) {\n                errorModalContent.html(`<p class=\"text-center\">${response.message}</p>`);\n                errorModal.modal('show');\n                return;\n            }\n            window.location.href = '/local/grupomakro_core/pages/institutionmanagement.php';\n        }).fail(function(error) {\n            window.alert(error);\n        });\n    });\n\n};\n\nconst handleEditButton = () => {\n    editInstitutionButtons.click((event)=>{\n        institutionId = event.currentTarget.attributes['institution-id'].value;\n        const selectedInstitution = institutions.find(institution => institutionId === institution.id);\n        updateInstitutionNameInput.val(selectedInstitution.name);\n        updateInstitutionIdInput.val(selectedInstitution.institutionid);\n        updateInstitutionModal.modal('show');\n    });\n\n};\n\nconst handleSaveButton = () => {\n    saveInstitutionButton.click(()=> {\n        // Check the select inputs and the time inputs\n        const valid = createInputs.every(input => {\n            return input.get(0).reportValidity();\n        });\n        if (!valid) {\n            return;\n        }\n        //\n\n        const args = {\n            name: createInstitutionNameInput.val(),\n            institutionId: createInstitutionIdInput.val()\n\n        };\n        const promise = Ajax.call([{\n            methodname: 'local_grupomakro_create_institution',\n            args\n        }]);\n        promise[0].done(function(response) {\n            if (response.institutionId === -1) {\n                errorModalContent.html(`<p class=\"text-center\">${response.message}</p>`);\n                errorModal.modal('show');\n                return;\n            }\n            window.location.href = '/local/grupomakro_core/pages/institutionmanagement.php';\n        }).fail(function(error) {\n            window.alert(error);\n        });\n    });\n};\n\n\n"],"names":["createInstitutionNameInput","createInstitutionIdInput","saveInstitutionButton","updateInstitutionNameInput","updateInstitutionIdInput","updateInstitutionButton","updateInstitutionModal","deleteInstitutionModal","editInstitutionButtons","deleteInstitutionButtons","viewInstitutionButtons","confirmDeleteInstitutionButton","errorModal","errorModalContent","createInputs","updateInputs","institutions","institutionId","institutionList","handleSaveButton","handleEditButton","handleUpdateButton","handleDeleteButton","handleConfirmDeletionButton","handleViewInstitutionButton","click","event","currentTarget","attributes","value","window","location","href","args","id","Ajax","call","methodname","done","response","modal","html","message","fail","error","alert","every","input","get","reportValidity","name","val","selectedInstitution","find","institution","institutionid"],"mappings":"8nCAGMA,4BAA6B,qEAAE,4BAC/BC,0BAA2B,mBAAE,0BAC7BC,uBAAwB,mBAAE,0BAC1BC,4BAA6B,mBAAE,4BAC/BC,0BAA2B,mBAAE,0BAC7BC,yBAA0B,mBAAE,4BAC5BC,wBAAyB,mBAAE,+BAC3BC,wBAAyB,mBAAE,+BAC3BC,wBAAyB,mBAAE,4BAC3BC,0BAA2B,mBAAE,8BAC7BC,wBAAyB,mBAAE,qBAC3BC,gCAAiC,mBAAE,mCAEnCC,YAAa,mBAAE,eACfC,mBAAoB,mBAAE,wBAEtBC,aAAe,CAACd,2BAA4BC,0BAC5Cc,aAAe,CAACZ,2BAA4BC,8BAE9CY,aACAC,4BAEiBC,kBACjBF,aAAeE,gBACfC,mBACAC,mBACAC,qBACAC,qBACAC,8BACAC,qCAGEA,4BAA8B,KAChCd,uBAAuBe,OAAOC,QAC1BT,cAAgBS,MAAMC,cAAcC,WAAW,kBAAkBC,MACjEC,OAAOC,SAASC,KAAQ,8DAA6Df,oBAIvFM,4BAA8B,KAChCZ,+BAA+Bc,OAAM,WAC3BQ,KAAO,CACTC,GAAIjB,eAEQkB,KAAKC,KAAK,CAAC,CACvBC,WAAY,sCACZJ,KAAAA,QAEI,GAAGK,MAAK,SAASC,cACW,IAA5BA,SAAStB,qBACTV,uBAAuBiC,MAAM,QAC7B3B,kBAAkB4B,KAAM,0BAAyBF,SAASG,oBAC1D9B,WAAW4B,MAAM,QAGrBV,OAAOC,SAASC,KAAO,4DACxBW,MAAK,SAASC,OACbd,OAAOe,MAAMD,cAOnBtB,mBAAqB,KACvBb,yBAAyBgB,OAAOC,QAC5BT,cAAgBS,MAAMC,cAAcC,WAAW,kBAAkBC,MACjEtB,uBAAuBiC,MAAM,YAK/BnB,mBAAqB,KACvBhB,wBAAwBoB,OAAM,SAEZV,aAAa+B,OAAMC,OACtBA,MAAMC,IAAI,GAAGC,gCAMlBhB,KAAO,CACTC,GAAIjB,cACJiC,KAAM/C,2BAA2BgD,MACjClC,cAAeb,yBAAyB+C,OAG5BhB,KAAKC,KAAK,CAAC,CACvBC,WAAY,sCACZJ,KAAAA,QAEI,GAAGK,MAAK,SAASC,cACW,IAA5BA,SAAStB,qBACTJ,kBAAkB4B,KAAM,0BAAyBF,SAASG,oBAC1D9B,WAAW4B,MAAM,QAGrBV,OAAOC,SAASC,KAAO,4DACxBW,MAAK,SAASC,OACbd,OAAOe,MAAMD,cAMnBxB,iBAAmB,KACrBZ,uBAAuBiB,OAAOC,QAC1BT,cAAgBS,MAAMC,cAAcC,WAAW,kBAAkBC,YAC3DuB,oBAAsBpC,aAAaqC,MAAKC,aAAerC,gBAAkBqC,YAAYpB,KAC3F/B,2BAA2BgD,IAAIC,oBAAoBF,MACnD9C,yBAAyB+C,IAAIC,oBAAoBG,eACjDjD,uBAAuBkC,MAAM,YAK/BrB,iBAAmB,KACrBjB,sBAAsBuB,OAAM,SAEVX,aAAagC,OAAMC,OACtBA,MAAMC,IAAI,GAAGC,gCAOlBhB,KAAO,CACTiB,KAAMlD,2BAA2BmD,MACjClC,cAAehB,yBAAyBkD,OAG5BhB,KAAKC,KAAK,CAAC,CACvBC,WAAY,sCACZJ,KAAAA,QAEI,GAAGK,MAAK,SAASC,cACW,IAA5BA,SAAStB,qBACTJ,kBAAkB4B,KAAM,0BAAyBF,SAASG,oBAC1D9B,WAAW4B,MAAM,QAGrBV,OAAOC,SAASC,KAAO,4DACxBW,MAAK,SAASC,OACbd,OAAOe,MAAMD"}