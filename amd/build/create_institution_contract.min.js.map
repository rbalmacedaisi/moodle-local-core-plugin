{"version":3,"file":"create_institution_contract.min.js","sources":["../src/create_institution_contract.js"],"sourcesContent":["import * as Ajax from 'core/ajax';\nimport $ from 'jquery';\n\nconst contractNumberInput = $('#contractnumber')\nconst startDateInput = $('#startdate')\nconst endDateInput = $('#enddate')\nconst budgetInput = $('#budget')\nconst billingConditionInput = $('#billing_condition')\nconst saveContractButton = $('#save-contract-button')\nconst cancelContractCreationButton = $('#cancel-contract-creation-button')\n\nconst contractInputs = [contractNumberInput,startDateInput,endDateInput,budgetInput,billingConditionInput]\n\nconst errorModal = $('#errorModal');\nconst errorModalContent = $('#error-modal-content');\n\nlet selectedInstitutionId;\n\nexport const init = (institutionId) => {\n    selectedInstitutionId = institutionId\n    handleSaveContractButtonClick()\n    handleBudgetInput()\n    handleContractCreationButtonClick()\n};\n\nconst handleSaveContractButtonClick = () => {\n    saveContractButton.click(()=>{\n        endDateInput.get(0).setCustomValidity('');\n        // Check the select inputs and the time inputs\n        const valid = contractInputs.every(input => {\n            return input.get(0).reportValidity();\n        });\n        if (!valid) {\n            return;\n        }\n        //\n        \n        // Check if the init time is less than the end time of the class\n        if (startDateInput.val() >= endDateInput.val()) {\n            endDateInput.get(0).setCustomValidity('La fecha de finalizaci√≥n debe ser mayor a la hora de inicio.');\n            endDateInput.get(0).reportValidity();\n            return;\n        }\n        //\n        \n        const args = {\n            institutionId:selectedInstitutionId,\n            contractId:contractNumberInput.val(),\n            initDate: startDateInput.val(),\n            expectedEndDate: endDateInput.val(),\n            budget: budgetInput.val(),\n            billingCondition: billingConditionInput.val(),\n        };\n\n        const promise = Ajax.call([{\n            methodname: 'local_grupomakro_create_institution_contract',\n            args\n        }, ]);\n        promise[0].done(function(response) {\n            if(response.institutionContractId === -1 ){\n                errorModalContent.html(`<p class=\"text-center\">${response.message}</p>`);\n                errorModal.modal('show');\n                return   \n            }\n            window.location.href = `/local/grupomakro_core/pages/institutionalcontracts.php?id=${selectedInstitutionId}`;\n        }).fail(function(error) {\n            console.error(error)\n        });\n    })\n}\n\nconst handleBudgetInput = () => {\n    budgetInput.on('input', function() {\n      var value = $(this).val().replace(/[^\\d]/g, ''); // Remove non-digit characters\n      value = value.replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.'); // Add dots as thousands separators\n      $(this).val(value); // Set the formatted value back to the input\n    });\n}\n\nconst handleContractCreationButtonClick = ()=>{\n    cancelContractCreationButton.click(()=>{\n        window.location.href = `/local/grupomakro_core/pages/institutionalcontracts.php?id=${selectedInstitutionId}`;\n    })\n    \n}\n\n"],"names":["selectedInstitutionId","contractNumberInput","startDateInput","endDateInput","budgetInput","billingConditionInput","saveContractButton","cancelContractCreationButton","contractInputs","errorModal","errorModalContent","institutionId","handleSaveContractButtonClick","handleBudgetInput","handleContractCreationButtonClick","click","get","setCustomValidity","every","input","reportValidity","val","args","contractId","initDate","expectedEndDate","budget","billingCondition","Ajax","call","methodname","done","response","institutionContractId","html","message","modal","window","location","href","fail","error","console","on","value","this","replace"],"mappings":"84CAgBIA,sBAbEC,qBAAsB,qEAAE,mBACxBC,gBAAiB,mBAAE,cACnBC,cAAe,mBAAE,YACjBC,aAAc,mBAAE,WAChBC,uBAAwB,mBAAE,sBAC1BC,oBAAqB,mBAAE,yBACvBC,8BAA+B,mBAAE,oCAEjCC,eAAiB,CAACP,oBAAoBC,eAAeC,aAAaC,YAAYC,uBAE9EI,YAAa,mBAAE,eACfC,mBAAoB,mBAAE,sCAIR,SAACC,eACjBX,sBAAwBW,cACxBC,gCACAC,oBACAC,yCAGEF,8BAAgC,WAClCN,mBAAmBS,OAAM,cACrBZ,aAAaa,IAAI,GAAGC,kBAAkB,IAExBT,eAAeU,OAAM,SAAAC,cACxBA,MAAMH,IAAI,GAAGI,wBAQpBlB,eAAemB,OAASlB,aAAakB,aACrClB,aAAaa,IAAI,GAAGC,kBAAkB,qEACtCd,aAAaa,IAAI,GAAGI,qBAKlBE,KAAO,CACTX,cAAcX,sBACduB,WAAWtB,oBAAoBoB,MAC/BG,SAAUtB,eAAemB,MACzBI,gBAAiBtB,aAAakB,MAC9BK,OAAQtB,YAAYiB,MACpBM,iBAAkBtB,sBAAsBgB,OAG5BO,KAAKC,KAAK,CAAC,CACvBC,WAAY,+CACZR,KAAAA,QAEI,GAAGS,MAAK,SAASC,cACkB,IAApCA,SAASC,6BACRvB,kBAAkBwB,sCAA+BF,SAASG,sBAC1D1B,WAAW2B,MAAM,QAGrBC,OAAOC,SAASC,0EAAqEvC,0BACtFwC,MAAK,SAASC,OACbC,QAAQD,MAAMA,eAKpB5B,kBAAoB,WACtBT,YAAYuC,GAAG,SAAS,eAClBC,OAAQ,mBAAEC,MAAMxB,MAAMyB,QAAQ,SAAU,IAC5CF,MAAQA,MAAME,QAAQ,wBAAyB,yBAC7CD,MAAMxB,IAAIuB,WAIZ9B,kCAAoC,WACtCP,6BAA6BQ,OAAM,WAC/BsB,OAAOC,SAASC,0EAAqEvC"}